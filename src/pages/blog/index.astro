---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

const posts = (await getCollection('blog', ({ data }) => !data.draft))
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
---

<BaseLayout title="Blog | Andrei Nicolae">
  <h1>Blog</h1>
  {posts.length === 0 ? (
    <p>No posts yet.</p>
  ) : (
    <ul class="post-list">
      {posts.map((post) => {
        const formattedDate = post.data.date.toLocaleDateString('en-US', {
          year: 'numeric',
          month: 'long',
          day: 'numeric'
        });
        return (
          <li>
            <time datetime={post.data.date.toISOString()}>{formattedDate}</time>
            <a href={`/blog/${post.slug}`}>{post.data.title}</a>
          </li>
        );
      })}
    </ul>
  )}
</BaseLayout>
